- how collected data can help the Security team in case of Security Incidents?
В первую очередь, эти данные с настроенными уведомлениями позволят команде оперативно реагировать на инциденты, быстро устранять последствия и контролировать соблюдение сотрудниками компании политик безопасности.
- can we collect any additional data to enrich collected events?
Добавить мониторинг описания чата.
Добавить мониторинг всех сообщений, а не только последнего (Лучше настроить скрипт на получение обновлений, чтобы не засорять БД Splunk)
Добавить мониторинг рассылаемых ссылок в сообщениях, настроив исключения на те сайты, на которые планируешь ссылаться сам - вместе с прочими факторами, рассылка посторонней ссылки может служить дополнительным сигналом.
Добавить мониторинг по ключевым словам в сообщении.
- what use cases / correlations / alerts the Security team can make using the collected data?
Немедленная отправка уведомления специалистам SOC в случае возникновения одного из событий. В случае, если специалисты SOC не были предупреждены администраторами чата о планируемых изменениях настроек канала, в зависимости от проводимых изменений, необходимо связаться с администраторами, и, либо провести разъяснительные работы (если изменения легитимны, но предупреждения о них не поступило), либо лишить администратора со взломанным аккаунтом админских прав до восстановления доступа к аккаунту и смены пароля, провести расследование инцидента и откатить настройки обратно.
- any additional thoughts you consider relevant
В идеале, необходимо допускать к администрированию корпоративного канала только людей, у которых настроена мультифакторная аутентификация. Я не нашёл такого функционала у Телеграм, но, как вариант, это можно обеспечить политиками компании.


Комментарии по приложению:
Используемый скрипт для получения логов - test.py

Сообщения о смене имени канала имеют дополнительное поле: Channel_post.new_chat_title. По этому полю легко можно мониторить смену имени канала. Так же можно настроить мониторинг по полю Channel_post.chat.title. Это поле имеется у всех сообщений, поэтому, при мониторинге по нему, проще будет отследить все сообщения, отправленные после нелегитимной ссмены имени.
Сообщения о смене фото канала имеют дополнительное поле: Channel_post.new_chat_photo. По этому полю легко можно мониторить смену имени канала.
Смену ссылки на канал можно мониторить по полям сообщений Channel_post.chat.username. Механизм мониторинга по этому полю идентичен механизму мониторинга по полю Channel_post.chat.title
Мониторинг списка администраторов чата у меня получилось реализовать только с помощью добавления нестандартных библиотек (например, telethon) в скрипт. Однако, подключить их в Splunk по инструкциям (https://community.splunk.com/t5/Building-for-the-Splunk-Platform/How-to-import-Python-module-from-subdirectory-in-appserver/m-p/265438; https://community.splunk.com/t5/Building-for-the-Splunk-Platform/Import-non-native-python-libraries-into-Splunk/m-p/171610) у меня не вышло. Не хватило опыта с python/splunk и времени на то, чтобы разобраться.


04.02 доделал скрипт, подгрузил нужные библиотеки. Но словил запрет от телеграма на действия с каналами сразу после очистки логов Splunk, поэтому, логи короткие и не иллюстрируют все возможные изменения. Запрос в ТП Telegram уже направил, но когда получу ответ - неизвестно. 
Бот и Telethone используются одновременно, так как сам Telethone не позволяет получить актуальную ссылку на канал. Потенциальная проблема - бот может получить ссылку на канал, в котором выходил какой-то пост за последние сутки. Можно настроить проверку наличия новых собобщений, и, в случае их отсутсвия, настроить проверку по ссылке по умолчанию.
